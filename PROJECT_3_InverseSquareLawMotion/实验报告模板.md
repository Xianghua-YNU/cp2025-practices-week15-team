# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [邱炜程]
**学号：** [20231050173]
**完成日期：** [2025.6.6]

## 1. 实验目的

（请用1-2句话简要描述本次实验你希望达成的学习目标，例如：通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性，并验证能量守恒和角动量守恒。）
通过数值模拟研究不同能量和角动量条件下质点在平方反比引力场中的轨道特性（椭圆、抛物线、双曲线），验证能量守恒和角动量守恒定律，并分析轨道形状与力学参量的定量关系。


## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）
数值方法：

使用 scipy.integrate.solve_ivp 求解常微分方程组

方法参数：method='DOP853'（8阶显式Runge-Kutta法）

精度控制：rtol=1e-7, atol=1e-9

时间步长：自适应步长控制，输出点通过 t_eval 指定
### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）

#### `[solve_orbit]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 derivatives 函数的核心计算部分
def solve_orbit(initial_conditions, t_span, t_eval, gm_val):
    """
    使用 scipy.integrate.solve_ivp 求解轨道运动问题。

    参数:
        initial_conditions (list or np.ndarray): 初始状态 [x0, y0, vx0, vy0]。
        t_span (tuple): 积分时间区间 (t_start, t_end)。
        t_eval (np.ndarray): 需要存储解的时间点数组。
        gm_val (float): GM 值 (引力常数 * 中心天体质量)。

    返回:
        scipy.integrate.OdeSolution: solve_ivp 返回的解对象。
                                     可以通过 sol.y 访问解的数组，sol.t 访问时间点。
    
    实现提示:
    1. 调用 solve_ivp 函数。
    2. `fun` 参数应为你的 `derivatives` 函数。
    3. `args` 参数应为一个元组，包含传递给 `derivatives` 函数的额外参数 (gm_val,)。
    4. 可以选择合适的数值方法 (method)，如 'RK45' (默认) 或 'DOP853'。
    5. 设置合理的相对容差 (rtol) 和绝对容差 (atol) 以保证精度，例如 rtol=1e-7, atol=1e-9。
    """
    # TODO: 学生在此处实现代码
    sol = solve_ivp(derivatives,t_span,initial_conditions,method = 'DOP853',t_eval = t_eval,args=(gm_val,),rtol=1e-7, atol=1e-9)
    return sol
```

#### `[derivatives]` 实现思路：

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 solve_orbit 函数调用 solve_ivp 的部分
def derivatives(t, state_vector, gm_val):
    """
    计算状态向量 [x, y, vx, vy] 的导数。

    运动方程（直角坐标系）:
    dx/dt = vx
    dy/dt = vy
    dvx/dt = -GM * x / r^3
    dvy/dt = -GM * y / r^3
    其中 r = sqrt(x^2 + y^2)。

    参数:
        t (float): 当前时间 (solve_ivp 需要，但在此自治系统中不直接使用)。
        state_vector (np.ndarray): 一维数组 [x, y, vx, vy]，表示当前状态。
        gm_val (float): 引力常数 G 与中心天体质量 M 的乘积。

    返回:
        np.ndarray: 一维数组，包含导数 [dx/dt, dy/dt, dvx/dt, dvy/dt]。
    
    实现提示:
    1. 从 state_vector 中解包出 x, y, vx, vy。
    2. 计算 r_cubed = (x**2 + y**2)**1.5。
    3. 注意处理 r_cubed 接近零的特殊情况（例如，如果 r 非常小，可以设定一个阈值避免除以零）。
    4. 计算加速度 ax 和 ay。
    5. 返回 [vx, vy, ax, ay]。
    """
    # TODO: 学生在此处实现代码

    x, y, vx, vy = state_vector
    r_cubed = (x**2 + y**2)**1.5
    
    # 避免除以零
    if r_cubed <= 1e-10:
        r_cubed = 1e-10
    
    # 计算加速度 - 使用已定义的 r_cubed
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    
    return [vx, vy, ax, ay]
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**
![image](https://github.com/user-attachments/assets/524d1d33-d80c-425d-b623-c2a5948a5c9d)


```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了三种能量条件下的轨道：
 - 椭圆轨道 (E = [具体值]): [简要描述形状和特征]
 - 抛物线轨道 (E = [具体值]): [简要描述形状和特征]
 - 双曲线轨道 (E = [具体值]): [简要描述形状和特征]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```

**结果分析：**
（简要分析不同能量条件下轨道形状的差异及其物理意义。可以讨论能量与轨道是否束缚的关系。）

**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）

### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**
![image](https://github.com/user-attachments/assets/5e20884b-e058-475e-a8b1-35ad40106bea)

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[具体值] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [值]: [描述轨道形状，如偏心率]
 - L2 = [值]: [描述轨道形状]
 - L3 = [值]: [描述轨道形状]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**
（分析角动量大小对椭圆轨道形状（如偏心率、半长轴、半短轴）的影响。角动量如何改变轨道的“扁平”程度？）

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：** [描述问题]
**解决方法：** [描述你的解决思路和过程]

**问题2：** [描述问题]
**解决方法：** [描述你的解决思路和过程]

### 4.2 主要收获与体会
（用3-5句话总结你通过本次实验获得的主要知识、技能或感悟。例如，对轨道力学的理解加深、数值求解ODE的经验、数据可视化的技巧等。）

## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）

### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）

